/*!
 *
 * Vanilla-DataTables
 * Copyright (c) 2015 Karl Saunders (http://mobiuswebdesign.co.uk)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 0.0.6
 *
 */
!function(a,b){var c="DataTable";"function"==typeof define&&define.amd?define([],b(c)):"object"==typeof exports?module.exports=b(c):a[c]=b(c)}(this,function(a){"use strict";function n(a,c){var d={perPage:10,perPageSelect:[5,10,15,20,25],navPosition:"both",navButtons:!0,nextPrev:!0,prevText:"&lsaquo;",nextText:"&rsaquo;",sortable:!1,searchable:!1,fixedHeight:!0,info:!0,hideUnusedNavs:!1,plugins:[]};this.options=b(d,c);var e=a.tagName.toLowerCase();if("table"!=e)throw new Error("The selected element ("+e+") is not a table!");if(null===a.tHead&&this.options.sortable)throw new Error("The sortable option requires table headings!");this.table=a,this.thead=this.table.tHead,this.options.data&&this.jsonToTable(),this.tbody=this.table.tBodies[0],this.initialRows=Array.prototype.slice.call(this.tbody.rows),this.colspan=this.thead.rows[0].cells.length,this.initialised=!1,this.sortEnabled=!1,this.isIE=m(),this.paginators=[],this.currentPage=1,this.first_page=1,this.onFirstPage=!0,this.onLastPage=!1,this.info={items:0,pages:0,range:0},this.pages=[],this.searchPages=[],this.searching=!1,this.init()}var b=function(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},c=function(a){var b;return!isNaN(a)&&(b=parseFloat(a),(0|b)===b)},d=function(a){return Math.max(a.scrollWidth,a.offsetWidth,a.clientWidth)},e=function(a){return Math.max(a.scrollHeight,a.offsetHeight,a.clientHeight)},f=function(a,b){return a.classList?a.classList.contains(b):!!a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))},g=function(a,b){a.classList?a.classList.add(b):f(b)||(a.className=a.className.trim()+" "+b)},h=function(a,b){a.classList?a.classList.remove(b):f(b)&&(a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," "))},i=function(a,b){var c=document,d=c.createElement(a);if(b&&"object"==typeof b){var e;for(e in b)if("html"===e)d.innerHTML=b[e];else if("text"===e){var f=c.createTextNode(b[e]);d.appendChild(f)}else d.setAttribute(e,b[e])}return d},j=function(){return document.createDocumentFragment()},k=function(a,b){var c,d;1===b?(c=0,d=a.length):b===-1&&(c=a.length-1,d=-1);for(var e=!0;e;){e=!1;for(var f=c;f!=d;f+=b)if(a[f+b]&&a[f].value>a[f+b].value){var g=a[f],h=a[f+b],i=g;a[f]=h,a[f+b]=i,e=!0}}return a},l=function(a,b,c){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.call(c,d,a[d],a);else for(var e=0,f=a.length;e<f;e++)b.call(c,e,a[e],a)},m=function(a){var b=window.navigator.userAgent,c=b.indexOf("MSIE "),d=b.indexOf("Trident/");return c>0||d>0};return n.prototype={init:function(){if(!this.initialised){this.initialised=!0;var a=this,b=a.table.tHead.rows[0].cells,c=d(a.table);l(b,function(a,b){var e=d(b)/c*100;b.style.width=e+"%"}),this.initPages(),this.build(),this.table.on=function(b,c){a.table.addEventListener(b,function(b){c.call(a,this)})},this.options.plugins.length&&l(this.options.plugins,function(b,c){a[c]&&"function"==typeof a[c].init&&a[c].init(a)}),setTimeout(function(){a.emit("datatable.init")},10)}},initPages:function(){var a=this;this.searching&&(this.searchPages=this.searchRows.map(function(b,c){return c%a.options.perPage==0?a.searchRows.slice(c,c+a.options.perPage):null}).filter(function(a){return a})),this.pages=this.initialRows.map(function(b,c){return c%a.options.perPage==0?a.initialRows.slice(c,c+a.options.perPage):null}).filter(function(a){return a}),this.info.items=this.searching?this.searchRows.length:this.initialRows.length,this.info.pages=this.searching?this.searchPages.length:this.pages.length,this.last_page=this.info.pages},build:function(){var a=i("div",{class:"dataTable-top"}),b=i("div",{class:"dataTable-bottom"}),c=this.getSelect();this.wrapper=i("div",{class:"dataTable-wrapper"}),this.tableContainer=i("div",{class:"dataTable-container"}),this.label=i("div",{class:"dataTable-info"}),g(this.table,"dataTable-table"),b.appendChild(this.label),this.wrapper.appendChild(a),this.wrapper.appendChild(this.tableContainer),this.wrapper.appendChild(b),a.appendChild(c),this.options.searchable&&(this.searchInput=i("input",{type:"text",class:"dataTable-input",placeholder:"Search..."}),this.searchForm=i("div",{class:"dataTable-search"}),this.searchForm.appendChild(this.searchInput),a.appendChild(this.searchForm),g(a,"searchable")),this.showPage(),this.updateInfo();var f,d=i("ul",{class:"dataTable-pagination"});switch(this.paginators.push(d),this.options.navPosition){case"top":a.appendChild(d);break;case"bottom":b.appendChild(d);break;case"both":f=i("ul",{class:"dataTable-pagination"}),this.paginators.push(f),a.appendChild(d),b.appendChild(f)}this.setButtons(),this.setClasses(),this.options.sortable&&this.initSortable(),this.table.parentNode.insertBefore(this.wrapper,this.table),this.tableContainer.appendChild(this.table),this.options.fixedHeight&&(this.tableHeight=e(this.tableContainer),this.tableContainer.style.height=this.tableHeight+"px"),this.addEventListeners()},addEventListeners:function(){var a=this;a.searchRows=[],this.handleClickEvents=this.handleEvents.bind(this),this.table.addEventListener("click",this.handleClickEvents,!1),l(a.paginators,function(b,c){c.addEventListener("click",a.switchPage.bind(a),!1)}),a.selector.addEventListener("change",a.update.bind(a),!1),a.searchInput.addEventListener("keyup",a.search.bind(a),!1)},handleEvents:function(a){a=a||window.event;var b=a.target,c=b.nodeName.toLowerCase();if("a"===c&&f(b,"dataTable-sorter"))return void this.sortItems(a)},switchPage:function(a){a=a||window.event;var b=a.target,d=b.tagName.toLowerCase();if("a"===d){a.preventDefault();var e=b.getAttribute("data-page");if(e!=this.currentPage||!b.parentNode.classList.contains("active")){if(c(e)&&(this.currentPage=parseInt(e,10)),this.options.nextPrev){if("prev"==e){if(this.onFirstPage)return;this.currentPage--}if("next"==e){if(this.onLastPage)return;this.currentPage++}}this.showPage(this.currentPage-1),this.updateInfo(),this.setClasses(),this.emit("datatable.change")}}},showPage:function(a){a=a||0;var b=this.pages;if(this.searching&&(b=this.searchPages),b.length){var c=this,d=j();switch(this.truncate(),l(b[a],function(a,b){d.appendChild(b)}),c.tbody.appendChild(d),this.onFirstPage=!1,this.onLastPage=!1,this.currentPage){case 1:this.onFirstPage=!0;break;case this.last_page:this.onLastPage=!0}}},updateInfo:function(){if(this.options.info){var a=this.searching?this.searchPages:this.pages,b=0,c=0,d=0;a.length&&(b=this.currentPage-1,c=b*this.options.perPage,d=c+a[b].length,c+=1);var e=["Showing ",c," to ",d," of ",this.info.items," rows"];this.label.innerHTML=e.join("")}},search:function(a){var b=this,c=this.searchInput.value.toLowerCase();j();return this.emit("datatable.search"),this.searching=!0,this.searchRows=[],c.length?(this.truncate(),l(b.pages,function(a,d){l(d,function(a,d){l(d.cells,function(a,e){var f=e.textContent.toLowerCase(),g=b.searchRows.indexOf(d)>-1;f.indexOf(c)>-1&&!g&&b.searchRows.push(d)})})}),b.searchRows.length||b.setMessage("No entries found."),void this.update()):(this.searching=!1,void this.update())},setMessage:function(a){this.truncate(),this.tbody.appendChild(i("tr",{html:'<td class="dataTables-empty" colspan="'+this.colspan+'">'+a+"</td>"}))},setButtons:function(){var a=this,b=this.searching?this.searchPages:this.pages;l(a.paginators,function(c,d){var e=j();d.innerHTML="",b.length<=1||(a.options.nextPrev&&e.appendChild(a.getButton("prev")),a.options.navButtons&&l(b,function(a,b){var c=i("li",{class:0==a?"active":""}),d=i("a",{href:"#","data-page":a+1,html:a+1});c.appendChild(d),e.appendChild(c)}),a.options.nextPrev&&e.appendChild(a.getButton("next")),d.appendChild(e))})},setClasses:function(a){var b=this,c=b.onFirstPage,d=b.onLastPage,e=b.options.nextPrev,f=b.options.hideUnusedNavs;l(b.paginators,function(a,i){var j=i.children,k=f?"hidden":"disabled";l(j,function(a,b){h(b,"active"),h(b,"disabled"),h(b,"hidden")}),c&&b.options.nextPrev&&g(i.firstElementChild,k),d&&b.options.nextPrev&&g(i.lastElementChild,k);var m=e?b.currentPage:b.currentPage-1;g(i.children[m],"active")})},getButton:function(a){var b=i("li"),c=i("a",{href:"#","data-page":a,html:"prev"==a?this.options.prevText:this.options.nextText});return b.appendChild(c),b},update:function(a){a&&(a=a||window.event,a.target===this.selector&&(this.options.perPage=parseInt(a.target.value,10)),this.emit("datatable.perpage")),this.currentPage=1,this.tableContainer.style.height=null,this.initPages(),this.showPage(),this.setButtons(),this.updateInfo(),this.tableHeight=e(this.tableContainer),this.tableContainer.style.height=this.tableHeight+"px"},initSortable:function(){if(!this.sortEnabled){var a=this,b=a.thead.rows[0].cells;l(b,function(a,b){var c=b.innerHTML,d=i("a",{href:"#",class:"dataTable-sorter",html:c});b.idx=a,b.innerHTML="",b.appendChild(d)}),this.sortEnabled=!0}},sortItems:function(a){a=a||window.e;var b=this,c=a.target;if("a"===c.nodeName.toLowerCase()){a.preventDefault();var d,e=b.searching?b.searchRows:b.initialRows,i=[],j=[],m=0,n=0,o=c.parentNode;l(e,function(a,b){var c=b.cells[o.idx],d=c.textContent?c.textContent:c.innerText,e=d.replace(/(\$|\,|\s)/g,"");parseFloat(e)==e?j[n++]={value:Number(e),row:b}:i[m++]={value:d,row:b}});var q,r;f(o,"asc")?(q=k(i,-1),r=k(j,-1),d="descending",h(o,"asc"),g(o,"desc")):(q=k(j,1),r=k(i,1),d="ascending",h(o,"desc"),g(o,"asc")),this.lastTh&&o!=this.lastTh&&(h(this.lastTh,"desc"),h(this.lastTh,"asc")),this.lastTh=o;var e=q.concat(r);b.searching?(b.searchRows=[],l(e,function(a,c){b.searchRows.push(c.row)})):(b.initialRows=[],l(e,function(a,c){b.initialRows.push(c.row)})),b.sortOrder=d,b.update(a),b.emit("datatable.sort")}},getSelect:function(){var a=j(),b=i("div",{class:"dataTable-selectWrapper"}),c=i("select",{class:"dataTable-selector"}),d=i("span",{html:"Showing"}),e=i("span",{html:"entries"});return l(this.options.perPageSelect,function(a,b){var d=i("option",{value:b,html:b});c.appendChild(d)}),c.value=this.options.perPage,a.appendChild(d),a.appendChild(c),a.appendChild(e),b.appendChild(a),this.selector=c,b},truncate:function(){if(this.isIE)for(;this.tbody.hasChildNodes();)this.tbody.removeChild(this.tbody.firstChild);else this.tbody.innerHTML=""},emit:function(a){this.table.dispatchEvent(new Event(a))},jsonToTable:function(){var a=j(),b=i("tbody");l(this.options.data,function(b,c){var d=i("tr");l(c,function(a,b){var c=i("td",{html:b});d.appendChild(c)}),a.appendChild(d)}),b.appendChild(a),this.table.appendChild(b)}},n});