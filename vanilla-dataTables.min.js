/*!
 *
 __     __          _ _ _         ____        _       _____     _     _
 \ \   / /_ _ _ __ (_) | | __ _  |  _ \  __ _| |_ __ |_   _|_ _| |__ | | ___  ___
  \ \ / / _` | '_ \| | | |/ _` | | | | |/ _` | __/ _` || |/ _` | '_ \| |/ _ \/ __|
   \ V / (_| | | | | | | | (_| | | |_| | (_| | || (_| || | (_| | |_) | |  __/\__ \
    \_/ \__,_|_| |_|_|_|_|\__,_| |____/ \__,_|\__\__,_||_|\__,_|_.__/|_|\___||___/

 * Copyright (c) 2015 Karl Saunders (http://mobiuswebdesign.co.uk)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 0.0.4
 *
 */
!function(a,b){var c="DataTable";"function"==typeof define&&define.amd?define([],b(c)):"object"==typeof exports?module.exports=b(c):a[c]=b(c)}(this,function(a){"use strict";function j(a,c){this.initialised=!1,this.sortEnabled=!1,this.isIE=!1,this.paginators=[],this.initialRows=null,this.currentPage=1,this.first_page=1,this.onFirstPage=!0,this.onLastPage=!1,this.info={items:0,pages:0,range:0};var d=a.tagName.toLowerCase();if("table"!=d)throw new Error("The selected element ("+d+") is not a table!");if(null===a.tHead&&c.sortable)throw new Error("The sortable option requires table headings!");this.isIE=i(),this.table=a,this.thead=this.table.tHead,this.tbody=this.table.tBodies[0],this.initialRows=Array.prototype.slice.call(this.tbody.rows),this.pages=[],this.searchPages=[],this.searching=!1;var e={perPage:10,navPosition:"both",navButtons:!0,nextPrev:!0,prevText:"&lsaquo;",nextText:"&rsaquo;",sortable:!1,searchable:!1,fixedHeight:!0,info:!0,hideUnusedNavs:!1,perPageSelect:[5,10,15,20,25],change:function(){},sorted:function(){}};this.options=b(e,c),this.initialise()}var b=function(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},c=function(a){var b;return!isNaN(a)&&(b=parseFloat(a),(0|b)===b)},d=function(a){return Math.max(a.scrollWidth,a.offsetWidth,a.clientWidth)},e=function(a){return Math.max(a.scrollHeight,a.offsetHeight,a.clientHeight)},f=function(a,b){var c,d=document.createElement(a);if(b&&"object"==typeof b)for(c in b)if(c in d)"innerHTML"===c?d.innerHTML=b[c]:d[c]=b[c];else if("class"===c){if(""!==b[c])for(var e=b[c].split(" "),f=e.length-1;f>=0;f--)d.classList.add(e[f])}else d.setAttribute(c,b[c]);return d},g=function(a,b){var c,d;1===b?(c=0,d=a.length):b===-1&&(c=a.length-1,d=-1);for(var e=!0;e;){e=!1;for(var f=c;f!=d;f+=b)if(a[f+b]&&a[f].value>a[f+b].value){var g=a[f],h=a[f+b],i=g;a[f]=h,a[f+b]=i,e=!0}}return a},h=function(a,b,c){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.call(c,d,a[d],a);else for(var e=0,f=a.length;e<f;e++)b.call(c,e,a[e],a)},i=function(a){var b=window.navigator.userAgent,c=b.indexOf("MSIE "),d=b.indexOf("Trident/");return c>0||d>0};return j.prototype={initialise:function(){if(!this.initialised){this.initialised=!0;var a=this,b=a.table.tHead.rows[0].cells,c=d(a.table);h(b,function(a,b){var e=d(b)/c*100;b.style.width=e+"%"}),this.initPages(),this.build()}},initPages:function(){var a=this;this.searching&&(this.initialSearchRows=this.searchPages,this.searchPages=this.initialSearchRows.map(function(b,c){return c%a.options.perPage==0?a.initialSearchRows.slice(c,c+a.options.perPage):null}).filter(function(a){return a})),this.pages=this.initialRows.map(function(b,c){return c%a.options.perPage==0?a.initialRows.slice(c,c+a.options.perPage):null}).filter(function(a){return a}),this.info.items=this.searching?this.initialSearchRows.length:this.initialRows.length,this.info.pages=this.searching?this.searchPages.length:this.pages.length,this.last_page=this.info.pages},build:function(){var a=f("div",{class:"dataTable-top"}),b=f("div",{class:"dataTable-bottom"}),c=this.getSelector();this.wrapper=f("div",{class:"dataTable-wrapper"}),this.tableContainer=f("div",{class:"dataTable-container"}),this.label=f("div",{class:"dataTable-info"}),this.table.classList.add("dataTable-table"),b.appendChild(this.label),this.wrapper.appendChild(a),this.wrapper.appendChild(this.tableContainer),this.wrapper.appendChild(b),a.appendChild(c),this.options.searchable&&(this.searchInput=f("input",{type:"text",class:"dataTable-input",placeholder:"Search..."}),this.searchForm=f("div",{class:"dataTable-search"}),this.searchForm.appendChild(this.searchInput),a.appendChild(this.searchForm)),this.showPage(),this.updateInfo();var g,d=f("ul",{class:"dataTable-pagination"});switch(this.paginators.push(d),this.options.navPosition){case"top":a.appendChild(d);break;case"bottom":b.appendChild(d);break;case"both":g=f("ul",{class:"dataTable-pagination"}),this.paginators.push(g),a.appendChild(d),b.appendChild(g)}this.setButtons(),this.setClasses(),this.options.sortable&&this.initSortable(),this.table.parentNode.insertBefore(this.wrapper,this.table),this.tableContainer.appendChild(this.table),this.options.fixedHeight&&(this.tableContainer.style.height=e(this.tableContainer)+"px"),this.addEventListeners()},addEventListeners:function(){var a=this;a.searchPages=[],h(a.paginators,function(b,c){c.addEventListener("click",a.switchPage.bind(a),!1)}),a.selector.addEventListener("change",a.update.bind(a),!1),this.searchInput.addEventListener("keyup",function(b){var c=this.value.toLowerCase();document.createDocumentFragment();if(a.searching=!0,a.searchPages=[],!c.length)return a.searching=!1,void a.update();if(a.isIE)for(;a.tbody.hasChildNodes();)a.tbody.removeChild(a.tbody.firstChild);else a.tbody.innerHTML="";h(a.pages,function(b,d){h(d,function(b,d){h(d.cells,function(b,e){var f=e.textContent.toLowerCase(),g=a.searchPages.indexOf(d)>-1;f.includes(c)&&!g&&a.searchPages.push(d)})})}),a.update()},!1)},switchPage:function(a){a=a||window.event;var b=a.target,d=b.tagName.toLowerCase();if("a"==d){a.preventDefault();var e=b.getAttribute("data-page");if(e!=this.currentPage||!b.parentNode.classList.contains("active")){if(c(e)&&(this.currentPage=parseInt(e,10)),this.options.nextPrev){if("prev"==e){if(this.onFirstPage)return;this.currentPage--}if("next"==e){if(this.onLastPage)return;this.currentPage++}}this.showPage(this.currentPage-1),this.updateInfo(),this.setClasses(),this.options.change(this)}}},showPage:function(a){a=a||0;var b=this.pages;this.searching&&(b=this.searchPages);var c=this,d=document.createDocumentFragment();if(c.isIE)for(;c.tbody.hasChildNodes();)c.tbody.removeChild(c.tbody.firstChild);else this.tbody.innerHTML="";switch(h(b[a],function(a,b){d.appendChild(b)}),c.tbody.appendChild(d),this.onFirstPage=!1,this.onLastPage=!1,this.currentPage){case 1:this.onFirstPage=!0;break;case this.last_page:this.onLastPage=!0}},updateInfo:function(){if(!this.options.info)return void(this.label.innerHTML="");var a=this.searching?this.searchPages:this.pages;a.length<=1&&(this.label.innerHTML="");var b=this.currentPage-1,c=b*this.options.perPage,d=c+a[b].length,e="Showing {x} to {y} of {r} rows";this.label.innerHTML=e.replace("{x}",c+1).replace("{y}",d).replace("{r}",this.info.items)},setButtons:function(){var a=this,b=this.searching?this.searchPages:this.pages;h(a.paginators,function(c,d){d.innerHTML="",b.length<=1||(a.options.nextPrev&&d.appendChild(a.getButton("prev")),a.options.navButtons&&h(b,function(a,b){var c=f("li",{class:0==a?"active":""}),e=f("a",{href:"#","data-page":a+1}),g=document.createTextNode(a+1);e.appendChild(g),c.appendChild(e),d.appendChild(c)}),a.options.nextPrev&&d.appendChild(a.getButton("next")))})},setClasses:function(a){var b=this,c=b.onFirstPage,d=b.onLastPage,e=b.options.nextPrev,f=b.options.hideUnusedNavs;h(b.paginators,function(a,g){var i=g.children,j=f?"hidden":"disabled";h(i,function(a,c){b.isIE?c.setAttribute("class",""):c.classList.remove("active","disabled","hidden")}),c&&b.options.nextPrev&&g.firstElementChild.classList.add(j),d&&b.options.nextPrev&&g.lastElementChild.classList.add(j);var k=e?b.currentPage:b.currentPage-1;g.children[k].classList.add("active")})},getButton:function(a){var b=f("li"),c=f("a",{href:"#","data-page":a});return c.innerHTML="prev"==a?this.options.prevText:this.options.nextText,b.appendChild(c),b},update:function(a){if(a){a=a||window.event;var b=a.target;"select"==b.nodeName.toLowerCase()&&(this.options.perPage=parseInt(b.value,10))}this.currentPage=1,this.tableContainer.style.height=null,this.initPages(),this.showPage(),this.setButtons(),this.updateInfo(),this.tableContainer.style.height=e(this.tableContainer)+"px"},initSortable:function(){if(!this.sortEnabled){var a=this,b=a.thead.rows[0].cells;h(b,function(b,c){var d=c.innerHTML,e=f("a",{href:"#",class:"dataTable-sorter"});c.idx=b,c.innerHTML="",c.appendChild(e),e.innerHTML=d,e.onclick=function(b){return function(b){return a.sortItems(b),!1}}(this)}),this.sortEnabled=!0}},sortItems:function(a){a=a||window.event;var b=this,c=a.target;if("a"==c.nodeName.toLowerCase()){var d,e=b.initialRows,f=[],i=[],j=0,k=0,l=c.parentNode;h(e,function(a,b){var c=b.cells[l.idx],d=c.textContent?c.textContent:c.innerText,e=d.replace(/(\$|\,|\s)/g,"");parseFloat(e)==e?i[k++]={value:Number(e),row:b}:f[j++]={value:d,row:b}});var n,o;l.classList.contains("asc")?(n=g(f,-1),o=g(i,-1),l.classList.remove("asc"),l.classList.add("desc"),d="descending"):(n=g(i,1),o=g(f,1),l.classList.contains("desc")&&l.classList.remove("desc"),l.classList.add("asc"),d="ascending"),this.lastSortedTh&&l!=this.lastSortedTh&&(self.isIE?this.lastSortedTh.setAttribute("class",""):this.lastSortedTh.classList.remove("desc","asc")),this.lastSortedTh=l;var e=n.concat(o);this.initialRows=[],h(e,function(a,c){b.initialRows.push(c.row)}),b.update(a,!1),b.options.sorted(d,this)}},getSelector:function(){var a=document.createDocumentFragment(),b=f("div",{class:"dataTable-selectWrapper"}),c=f("select",{class:"dataTable-selector"}),d=f("span",{innerHTML:"Showing"}),e=f("span",{innerHTML:"entries"});return h(this.options.perPageSelect,function(a,b){var d=f("option",{value:b,innerHTML:b});c.appendChild(d)}),c.value=this.options.perPage,a.appendChild(d),a.appendChild(c),a.appendChild(e),b.appendChild(a),this.selector=c,b},destroy:function(){if(!(!this instanceof DataTable)){var a=this,b=a.thead.rows[0].cells;if(this.table.classList.remove("dataTable-table"),h(a.paginators,function(b,c){c.removeEventListener("click",a.switchPage)}),a.selector.removeEventListener("change",a.update),a.options.sortable&&h(b,function(a,b){var d=(b.firstElementChild,b.textContent?b.textContent:b.innerText);b.innerHTML=d}),a.isIE)for(;a.tbody.hasChildNodes();)a.tbody.removeChild(a.tbody.firstChild);else this.tbody.innerHTML="";var c=document.createDocumentFragment();h(this.initialRows,function(a,b){c.appendChild(b)}),a.tbody.appendChild(c),a.wrapper.parentNode.appendChild(a.table),a.wrapper.parentNode.removeChild(a.wrapper),this.initialised=!1}}},j});