/*!
 *
 __     __          _ _ _         ____        _       _____     _     _
 \ \   / /_ _ _ __ (_) | | __ _  |  _ \  __ _| |_ __ |_   _|_ _| |__ | | ___  ___
  \ \ / / _` | '_ \| | | |/ _` | | | | |/ _` | __/ _` || |/ _` | '_ \| |/ _ \/ __|
   \ V / (_| | | | | | | | (_| | | |_| | (_| | || (_| || | (_| | |_) | |  __/\__ \
    \_/ \__,_|_| |_|_|_|_|\__,_| |____/ \__,_|\__\__,_||_|\__,_|_.__/|_|\___||___/

 * Copyright (c) 2015 Karl Saunders (http://mobiuswebdesign.co.uk)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 0.0.3
 *
 */
!function(t,e){var i="DataTable";"function"==typeof define&&define.amd?define([],e(i)):"object"==typeof exports?module.exports=e(i):t[i]=e(i)}(this,function(t){"use strict";function e(t,e){this.initialised=!1,this.sortEnabled=!1,this.isIE=h(),this.sorters=[],this.paginators=[],this.initialRows=null,this.initialDimensions=[],this.currentPage=1,this.first_page=1,this.onFirstPage=!0,this.onLastPage=!1,this.info={items:0,pages:0,range:0};var s=t.tagName.toLowerCase();if("table"!=s)return void console.warn("ERROR: The selected element ("+s+") is not a table!");if(null===t.tHead&&e.sortable)return void console.warn("ERROR: The sortable option requires table headings!");this.table=t,this.thead=this.table.tHead,this.tbody=this.table.lastElementChild,this.initialRows=Array.prototype.slice.call(this.tbody.rows);var a={perPage:10,navPosition:"both",navButtons:!0,nextPrev:!0,prevText:"&lsaquo;",nextText:"&rsaquo;",sortable:!1,fixedHeight:!0,info:!0,hideUnusedNavs:!1,perPageSelect:[5,10,15,20,25],change:function(){}};this.options=i(a,e),this.initialise()}var i=function(t,e){var i;for(i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},s=function(t){var e;return isNaN(t)?!1:(e=parseFloat(t),(0|e)===e)},a=function(t){return Math.max(t.scrollWidth,t.offsetWidth,t.clientWidth)},n=function(t){return Math.max(t.scrollHeight,t.offsetHeight,t.clientHeight)},o=function(t,e){var i=document.createElement(t);if(e)for(var s in e)i.setAttribute(s,e[s]);return i},r=function(t,e){var i,s;1===e?(i=0,s=t.length):-1===e&&(i=t.length-1,s=-1);for(var a=!0;a;){a=!1;for(var n=i;n!=s;n+=e)if(t[n+e]&&t[n].value>t[n+e].value){var o=t[n],r=t[n+e],l=o;t[n]=r,t[n+e]=l,a=!0}}return t},l=function(t,e,i){if("[object Object]"===Object.prototype.toString.call(t))for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.call(i,s,t[s],t);else for(var a=0,n=t.length;n>a;a++)e.call(i,a,t[a],t)},h=function(t){var e=window.navigator.userAgent,i=e.indexOf("MSIE "),s=e.indexOf("Trident/");return i>0||s>0?!0:!1};return e.prototype={initialise:function(){this.initialised||(this.initialised=!0,this.setInitialDimensions(),this.initPages(),this.build())},setInitialDimensions:function(){var t=this,e=t.table.tHead.rows[0].cells,i=a(t.table);l(e,function(e,s){var n=a(s)/i*100;t.initialDimensions.push(n),s.style.width=n+"%"})},initPages:function(){var t=this;this.pages=this.initialRows.map(function(e,i){return i%t.options.perPage==0?t.initialRows.slice(i,i+t.options.perPage):null}).filter(function(t){return t}),this.info.items=this.initialRows.length,this.info.pages=this.pages.length,this.last_page=this.info.pages},build:function(){var t=o("div",{"class":"dataTable-top"}),e=o("div",{"class":"dataTable-bottom"}),i=this.getSelector();this.wrapper=o("div",{"class":"dataTable-wrapper"}),this.tableContainer=o("div",{"class":"dataTable-container"}),this.label=o("div",{"class":"dataTable-info"}),this.table.parentNode.insertBefore(this.wrapper,this.table),this.tableContainer.appendChild(this.table),e.appendChild(this.label),this.wrapper.appendChild(t),this.wrapper.appendChild(this.tableContainer),this.wrapper.appendChild(e),t.appendChild(i),this.showPage(),this.updateInfo();var s=o("ul",{"class":"dataTable-pagination"});switch(this.paginators.push(s),this.options.navPosition){case"top":t.appendChild(s);break;case"bottom":e.appendChild(s);break;case"both":var a=o("ul",{"class":"dataTable-pagination"});this.paginators.push(a),t.appendChild(s),e.appendChild(a)}this.setButtons(),this.setClasses(),this.options.sortable&&this.initSortable(),this.options.fixedHeight&&(this.tableContainer.style.height=n(this.tableContainer)+"px"),this.table.classList.add("dataTable-table"),this.addEventListeners()},addEventListeners:function(){var t=this;l(t.paginators,function(e,i){i.addEventListener("click",t.switchPage.bind(t),!1)}),t.selector.addEventListener("change",t.update.bind(t),!1)},switchPage:function(t){t=t||window.event;var e=t.target,i=e.tagName.toLowerCase();if("a"==i){t.preventDefault();var a=e.getAttribute("data-page");if(a!=this.currentPage||!e.parentNode.classList.contains("active")){if(s(a)&&(this.currentPage=parseInt(a,10)),this.options.nextPrev){if("prev"==a){if(this.onFirstPage)return;this.currentPage--}if("next"==a){if(this.onLastPage)return;this.currentPage++}}this.showPage(this.currentPage-1),this.updateInfo(),this.setClasses(),this.options.change(this)}}},showPage:function(t){t=t||0;var e=this,i=document.createDocumentFragment();if(e.isIE)for(;e.tbody.hasChildNodes();)e.tbody.removeChild(e.tbody.firstChild);else this.tbody.innerHTML="";switch(l(this.pages[t],function(t,e){i.appendChild(e)}),e.tbody.appendChild(i),this.onFirstPage=!1,this.onLastPage=!1,this.currentPage){case 1:this.onFirstPage=!0;break;case this.last_page:this.onLastPage=!0}},updateInfo:function(){if(!this.options.info)return void(this.label.innerHTML="");this.info.pages<=1&&(this.label.innerHTML="");var t=this.currentPage-1,e=t*this.options.perPage,i=e+this.pages[t].length;this.label.innerHTML="Showing "+(e+1)+" to "+i+" of "+this.info.items+" rows"},setButtons:function(){var t=this;l(t.paginators,function(e,i){i.innerHTML="",t.pages.length<=1||(t.options.nextPrev&&i.appendChild(t.getButton("prev")),t.options.navButtons&&l(t.pages,function(t,e){var s=o("li",{"class":0==t?"active":""}),a=o("a",{href:"#","data-page":t+1}),n=document.createTextNode(t+1);a.appendChild(n),s.appendChild(a),i.appendChild(s)}),t.options.nextPrev&&i.appendChild(t.getButton("next")))})},setClasses:function(t){var e=this,i=e.onFirstPage,s=e.onLastPage,a=e.options.nextPrev,n=e.options.hideUnusedNavs;l(e.paginators,function(t,o){var r=o.children,h=n?"hidden":"disabled";l(r,function(t,i){e.isIE?i.setAttribute("class",""):i.classList.remove("active","disabled","hidden")}),i&&e.options.nextPrev&&o.firstElementChild.classList.add(h),s&&e.options.nextPrev&&o.lastElementChild.classList.add(h);var d=a?e.currentPage:e.currentPage-1;o.children[d].classList.add("active")})},getButton:function(t){var e=o("li"),i=o("a",{href:"#","data-page":t});return i.innerHTML="prev"==t?this.options.prevText:this.options.nextText,e.appendChild(i),e},update:function(t){if(t){t=t||window.event;var e=t.target;"select"==e.nodeName.toLowerCase()&&(this.options.perPage=parseInt(e.value,10))}if(this.currentPage=1,this.tableContainer.style.height=null,this.initPages(),this.showPage(),this.setButtons(),this.updateInfo(),this.options.sortable)this.initSortable();else{var i=this.thead.rows[0].cells;l(i,function(t,e){e.innerHTML=e.textContent?e.textContent:e.innerText})}this.tableContainer.style.height=n(this.tableContainer)+"px"},initSortable:function(){if(!this.sortEnabled){var t=this,e=t.thead.rows[0].cells;l(e,function(e,i){var s=i.innerHTML,a=o("a",{href:"#","class":"dataTable-sorter"});i.cIdx=e,i.innerHTML="",i.appendChild(a),a.innerHTML=s,a.onclick=function(e){return function(e){return t.sortItems(e),!1}}(this)}),this.sortEnabled=!0}},sortItems:function(t){t=t||window.event;var e=this,i=t.target;if("a"==i.nodeName.toLowerCase()){var s=e.initialRows,a=[],n=[],o=0,h=0,d=i.parentElement,p=d.cIdx;l(s,function(t,e){var i=e.cells[p],s=i.textContent?i.textContent:i.innerText,r=s.replace(/(\$|\,|\s)/g,"");parseFloat(r)==r?n[h++]={value:Number(r),row:e}:a[o++]={value:s,row:e}});var c,u;d.classList.contains("asc")?(c=r(a,-1),u=r(n,-1),d.classList.remove("asc"),d.classList.add("desc")):(c=r(n,1),u=r(a,1),d.classList.contains("desc")?(d.classList.remove("desc"),d.classList.add("asc")):d.classList.add("asc")),this.lastSortedTh&&d!=this.lastSortedTh&&this.lastSortedTh.classList.remove("desc","asc"),this.lastSortedTh=d;var s=c.concat(u);this.initialRows=[],l(s,function(t,i){e.initialRows.push(i.row)}),e.update(t)}},getSelector:function(){var t=o("div",{"class":"dataTable-selectWrapper"}),e=o("select",{"class":"dataTable-selector"}),i=o("span"),s=o("span");return l(this.options.perPageSelect,function(t,i){var s=o("option");s.value=i,s.innerHTML=i,e.appendChild(s)}),e.value=this.options.perPage,i.innerHTML="Showing",s.innerHTML="entries",t.appendChild(i),t.appendChild(e),t.appendChild(s),this.selector=e,t}},e});