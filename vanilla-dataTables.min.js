/*!
 *
 * Vanilla-DataTables
 * Copyright (c) 2015 Karl Saunders (http://mobiuswebdesign.co.uk)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 0.0.7
 *
 */
!function(a,b){var c="DataTable";"function"==typeof define&&define.amd?define([],b(c)):"object"==typeof exports?module.exports=b(c):a[c]=b(c)}(this,function(a){"use strict";function j(a,c){var d={perPage:10,perPageSelect:[5,10,15,20,25],navPosition:"bottom",navButtons:!0,nextPrev:!0,prevText:"&lsaquo;",nextText:"&rsaquo;",sortable:!1,searchable:!1,fixedHeight:!1,info:!0,hideUnusedNavs:!1,plugins:[]};this.options=b(d,c);var e=a.tagName.toLowerCase();if("table"!=e)throw new Error("The selected element ("+e+") is not a table!");if(null===a.tHead&&this.options.sortable)throw new Error("The sortable option requires table headings!");this.table=a,this.thead=this.table.tHead,this.options.data&&this.jsonToTable(),this.tbody=this.table.tBodies[0],this.rows=Array.prototype.slice.call(this.tbody.rows),this.colspan=this.thead.rows[0].cells.length,this.initialised=!1,this.sortEnabled=!1,this.isIE=!!/(msie|trident)/i.test(navigator.userAgent),this.paginators=[],this.currentPage=1,this.first_page=1,this.onFirstPage=!0,this.onLastPage=!1,this.info={items:0,pages:0,range:0},this.pages=[],this.searchPages=[],this.searching=!1,this.init()}var b=function(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},c=function(a,b){return a.classList?a.classList.contains(b):!!a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))},d=function(a,b){a.classList?a.classList.add(b):c(b)||(a.className=a.className.trim()+" "+b)},e=function(a,b){a.classList?a.classList.remove(b):c(b)&&(a.className=a.className.replace(new RegExp("(^|\\c)"+b.split(" ").join("|")+"(\\c|$)","gi")," "))},f=function(){return document.createDocumentFragment()},g=function(a,b){var c=document,d=c.createElement(a);if(b&&"object"==typeof b){var e;for(e in b)if("html"===e)d.innerHTML=b[e];else if("text"===e){var f=c.createTextNode(b[e]);d.appendChild(f)}else d.setAttribute(e,b[e])}return d},h=function(a,b){var c,d;1===b?(c=0,d=a.length):b===-1&&(c=a.length-1,d=-1);for(var e=!0;e;){e=!1;for(var f=c;f!=d;f+=b)if(a[f+b]&&a[f].value>a[f+b].value){var g=a[f],h=a[f+b],i=g;a[f]=h,a[f+b]=i,e=!0}}return a},i=function(a,b,c){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.call(c,d,a[d],a);else for(var e=0,f=a.length;e<f;e++)b.call(c,e,a[e],a)};return j.prototype={init:function(){if(!this.initialised){var a=this;this.initPages(),this.build(),this.table.on=function(b,c){a.table.addEventListener(b,function(b){c.call(a,this)})},this.options.plugins.length&&i(this.options.plugins,function(b,c){a[c]&&"function"==typeof a[c].init&&a[c].init(a)}),setTimeout(function(){a.emit("datatable.init")},10),this.initialised=!0}},initPages:function(){var a=this;this.searching&&(this.searchPages=this.searchRows.map(function(b,c){return c%a.options.perPage==0?a.searchRows.slice(c,c+a.options.perPage):null}).filter(function(a){return a})),this.pages=this.rows.map(function(b,c){return c%a.options.perPage==0?a.rows.slice(c,c+a.options.perPage):null}).filter(function(a){return a}),this.info.items=this.searching?this.searchRows.length:this.rows.length,this.info.pages=this.searching?this.searchPages.length:this.pages.length,this.last_page=this.info.pages},build:function(){var a=this,b=g("div",{class:"dataTable-top"}),c=g("div",{class:"dataTable-bottom"}),e=this.getSelect();this.wrapper=g("div",{class:"dataTable-wrapper"}),this.tableContainer=g("div",{class:"dataTable-container"}),this.label=g("div",{class:"dataTable-info"}),d(this.table,"dataTable-table"),c.appendChild(this.label),this.wrapper.appendChild(b),this.wrapper.appendChild(this.tableContainer),this.wrapper.appendChild(c),b.appendChild(e),this.options.searchable&&(this.searchInput=g("input",{type:"text",class:"dataTable-input",placeholder:"Search..."}),this.searchForm=g("div",{class:"dataTable-search"}),this.searchForm.appendChild(this.searchInput),b.appendChild(this.searchForm),d(b,"searchable")),this.showPage(),this.updateInfo();var h,f=g("ul",{class:"dataTable-pagination"});switch(this.paginators.push(f),this.options.navPosition){case"top":b.appendChild(f);break;case"bottom":c.appendChild(f);break;case"both":h=g("ul",{class:"dataTable-pagination"}),this.paginators.push(h),b.appendChild(f),c.appendChild(h)}this.setButtons(),this.setClasses(),this.options.sortable&&this.initSortable(),this.table.parentNode.insertBefore(this.wrapper,this.table),this.tableContainer.appendChild(this.table),this.containerRect=this.tableContainer.getBoundingClientRect(),this.options.fixedHeight&&(this.tableContainer.style.height=this.containerRect.height+"px");var j=a.table.tHead.rows[0].cells;i(j,function(b,c){var d=c.getBoundingClientRect(),e=d.width/a.containerRect.width*100;c.style.width=e+"%"}),this.addEventListeners()},addEventListeners:function(){var a=this;a.searchRows=[],this.handleClickEvents=this.handleEvents.bind(this),this.wrapper.addEventListener("click",this.handleClickEvents,!1),a.selector.addEventListener("change",a.update.bind(a),!1),a.searchInput.addEventListener("keyup",a.search.bind(a),!1)},handleEvents:function(a){a=a||window.event;var b=a.target,d=b.nodeName.toLowerCase();"a"===d&&(b.hasAttribute("data-page")&&this.switchPage(b),c(b,"dataTable-sorter")&&this.sortItems(a),a.preventDefault())},switchPage:function(a){var b=a.getAttribute("data-page");if(b!=this.currentPage||!a.parentNode.classList.contains("active")){if(isNaN(b)||(this.currentPage=parseInt(b,10)),this.options.nextPrev){if("prev"==b){if(this.onFirstPage)return;this.currentPage--}if("next"==b){if(this.onLastPage)return;this.currentPage++}}this.showPage(this.currentPage-1),this.updateInfo(),this.setClasses(),this.emit("datatable.change")}},showPage:function(a){a=a||0;var b=this.pages;if(this.searching&&(b=this.searchPages),b.length){var c=this,d=f();switch(this.truncate(),i(b[a],function(a,b){d.appendChild(b)}),c.tbody.appendChild(d),this.onFirstPage=!1,this.onLastPage=!1,this.currentPage){case 1:this.onFirstPage=!0;break;case this.last_page:this.onLastPage=!0}}},updateInfo:function(){if(this.options.info){var a=this.searching?this.searchPages:this.pages,b=0,c=0,d=0;a.length&&(b=this.currentPage-1,c=b*this.options.perPage,d=c+a[b].length,c+=1);var e=["Showing ",c," to ",d," of ",this.info.items," rows"];this.label.innerHTML=e.join("")}},search:function(a){var b=this,c=this.searchInput.value.toLowerCase();return this.searching=!0,this.searchRows=[],c.length?(this.truncate(),i(b.pages,function(a,d){i(d,function(a,d){i(d.cells,function(a,e){var f=e.textContent.toLowerCase(),g=b.searchRows.indexOf(d)>-1;f.indexOf(c)>-1&&!g&&b.searchRows.push(d)})})}),b.searchRows.length||b.setMessage("No entries found."),this.update(),void this.emit("datatable.search")):(this.searching=!1,this.update(),void this.emit("datatable.search"))},setMessage:function(a){this.truncate(),this.tbody.appendChild(g("tr",{html:'<td class="dataTables-empty" colspan="'+this.colspan+'">'+a+"</td>"}))},setButtons:function(){var a=this,b=this.searching?this.searchPages:this.pages;i(a.paginators,function(c,d){var e=f();d.innerHTML="",b.length<=1||(a.options.nextPrev&&e.appendChild(a.getButton("prev")),a.options.navButtons&&i(b,function(a,b){var c=g("li",{class:0==a?"active":""}),d=g("a",{href:"#","data-page":a+1,html:a+1});c.appendChild(d),e.appendChild(c)}),a.options.nextPrev&&e.appendChild(a.getButton("next")),d.appendChild(e))})},setClasses:function(a){var b=this,c=b.onFirstPage,f=b.onLastPage,g=b.options.nextPrev,h=b.options.hideUnusedNavs;i(b.paginators,function(a,j){var k=j.children,l=h?"hidden":"disabled";i(k,function(a,b){e(b,"active"),e(b,"disabled"),e(b,"hidden")}),c&&b.options.nextPrev&&d(j.firstElementChild,l),f&&b.options.nextPrev&&d(j.lastElementChild,l);var m=g?b.currentPage:b.currentPage-1;d(j.children[m],"active")})},getButton:function(a){var b=g("li"),c=g("a",{href:"#","data-page":a,html:"prev"==a?this.options.prevText:this.options.nextText});return b.appendChild(c),b},update:function(a){if(a){var b=a.target;b===this.selector&&(this.options.perPage=parseInt(b.value,10)),this.emit("datatable.perpage")}this.currentPage=1,this.initPages(),this.showPage(),this.setButtons(),this.updateInfo(),this.tableContainer.style.height=null,this.options.fixedHeight&&(this.containerRect=this.tableContainer.getBoundingClientRect(),this.tableContainer.style.height=this.containerRect.height+"px")},initSortable:function(){if(!this.sortEnabled){var a=this,b=a.thead.rows[0].cells;i(b,function(a,b){var c=g("a",{href:"#",class:"dataTable-sorter",html:b.innerHTML});b.idx=a,b.innerHTML="",b.appendChild(c)}),this.sortEnabled=!0}},sortItems:function(a){var g,b=this,f=a.target,j=b.searching?b.searchRows:b.rows,k=[],l=[],m=0,n=0,o=f.parentNode;i(j,function(a,b){var c=b.cells[o.idx],d=c.textContent?c.textContent:c.innerText,e=d.replace(/(\$|\,|\s)/g,"");parseFloat(e)==e?l[n++]={value:Number(e),row:b}:k[m++]={value:d,row:b}});var q,r;c(o,"asc")?(q=h(k,-1),r=h(l,-1),g="descending",e(o,"asc"),d(o,"desc")):(q=h(l,1),r=h(k,1),g="ascending",e(o,"desc"),d(o,"asc")),this.lastTh&&o!=this.lastTh&&(e(this.lastTh,"desc"),e(this.lastTh,"asc")),this.lastTh=o;var j=q.concat(r);b.searching?(b.searchRows=[],i(j,function(a,c){b.searchRows.push(c.row)})):(b.rows=[],i(j,function(a,c){b.rows.push(c.row)})),b.sortOrder=g,b.update(a),b.emit("datatable.sort")},getSelect:function(){var a=f(),b=g("div",{class:"dataTable-selectWrapper"}),c=g("select",{class:"dataTable-selector"}),d=g("span",{html:"Showing"}),e=g("span",{html:"entries"});return i(this.options.perPageSelect,function(a,b){var d=g("option",{value:b,html:b});c.appendChild(d)}),c.value=this.options.perPage,a.appendChild(d),a.appendChild(c),a.appendChild(e),b.appendChild(a),this.selector=c,b},truncate:function(){if(this.isIE)for(;this.tbody.hasChildNodes();)this.tbody.removeChild(this.tbody.firstChild);else this.tbody.innerHTML=""},emit:function(a){this.table.dispatchEvent(new Event(a))},jsonToTable:function(){var a=f(),b=g("tbody");i(this.options.data,function(b,c){var d=g("tr");i(c,function(a,b){var c=g("td",{html:b});d.appendChild(c)}),a.appendChild(d)}),b.appendChild(a),this.table.appendChild(b)}},j});